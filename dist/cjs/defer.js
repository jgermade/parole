"use strict";var p=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var j=(t,n)=>{for(var i in n)p(t,i,{get:n[i],enumerable:!0})},C=(t,n,i,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of N(n))!b.call(t,a)&&a!==i&&p(t,a,{get:()=>n[a],enumerable:!(r=I(n,a))||r.enumerable});return t};var R=t=>C(p({},"__esModule",{value:!0}),t);var J={};j(J,{defer:()=>T});module.exports=R(J);var h=require("./nextTick"),u=require("./type-cast"),d=(r=>(r.PENDING="PENDING",r.FULFILLED="FULFILLED",r.REJECTED="REJECTED",r))(d||{});const{PENDING:G,FULFILLED:m,REJECTED:y}=d;function T(){let t,n=G,i=[],r=[];const a={then(e=null,c=null){const{resolve:o,reject:l,promise:E}=T(),v=(0,u.isFunction)(e)?s=>{try{o(e(s))}catch(F){l(F)}}:s=>o(s),L=(0,u.isFunction)(c)?s=>{try{o(c(s))}catch(F){l(F)}}:s=>l(s);return n===m?(0,h.nextTick)(()=>v(t)):n===y?(0,h.nextTick)(()=>L(t)):(i==null||i.push(v),r==null||r.push(L)),E}};function f(e,c){t=e,n=c,(0,h.nextTick)(()=>{const o=c===m?i:r;i=null,r=null,o==null||o.forEach(l=>{try{l(t)}catch(E){f(E,y)}})})}function D(e){let c=!1;try{if(e===a)throw new TypeError("resolve value is the promise itself");const o=e&&((0,u.isObject)(e)||(0,u.isFunction)(e))&&e.then;if((0,u.isFunction)(o))o.call(e,l=>{c||(c=!0,D(l))},l=>{c||(c=!0,f(l,y))});else{if(c)return;f(e,m)}}catch(o){if(c)return;f(o,y)}}return{promise:a,resolve:D,reject(e){f(e,y)}}}
