"use strict";var a=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var D=(l,e)=>{for(var t in e)a(l,t,{get:e[t],enumerable:!0})},L=(l,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of F(e))!C.call(l,n)&&n!==t&&a(l,n,{get:()=>e[n],enumerable:!(i=m(e,n))||i.enumerable});return l};var R=l=>L(a({},"__esModule",{value:!0}),l);var j={};D(j,{Future:()=>d});module.exports=R(j);var h=require("./nextTick"),u=require("./type-cast"),v=(i=>(i.PENDING="PENDING",i.FULFILLED="FULFILLED",i.REJECTED="REJECTED",i))(v||{});const{PENDING:Q,FULFILLED:f,REJECTED:r}=v;class d{constructor(e){this.value=null;this.state=Q;this.fulfillQueue=[];this.rejectQueue=[];try{e(this.doResolve.bind(this),this.doReject.bind(this))}catch(t){this.doReject(t)}}doComplete(e,t){this.value=e,this.state=t,(0,h.nextTick)(()=>{const i=t===f?this.fulfillQueue:this.rejectQueue;this.fulfillQueue=null,this.rejectQueue=null,i==null||i.forEach(n=>{try{n(e)}catch(o){this.doComplete(o,r)}})})}doResolve(e){let t=!1;try{if(e===this)throw new TypeError("resolve value is the promise itself");const i=e&&((0,u.isObject)(e)||(0,u.isFunction)(e))&&e.then;if((0,u.isFunction)(i))i.call(e,n=>{t||(t=!0,this.doResolve(n))},n=>{t||(t=!0,this.doComplete(n,r))});else{if(t)return;this.doComplete(e,f)}}catch(i){if(t)return;this.doComplete(i,r)}}doReject(e){this.doComplete(e,r)}then(e=null,t=null){return new d((i,n)=>{var y,E;const o=(0,u.isFunction)(e)?s=>{try{i(e(s))}catch(c){n(c)}}:s=>i(s),p=(0,u.isFunction)(t)?s=>{try{i(t(s))}catch(c){n(c)}}:s=>n(s);this.state===f?(0,h.nextTick)(()=>o(this.value)):this.state===r?(0,h.nextTick)(()=>p(this.value)):((y=this.fulfillQueue)==null||y.push(o),(E=this.rejectQueue)==null||E.push(p))})}}
