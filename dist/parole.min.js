!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Parole=n()}(this,function(){"use strict";var e="object"!=typeof window?"object"==typeof process&&"function"==typeof process.nextTick&&process.nextTick||"object"==typeof global&&(global.setInmediate||global.setTimeout):function(e,n){for(var t=n.length-1;t>=0;t--)if(e[n[t]+"equestAnimationFrame"])return e[n[t]+"equestAnimationFrame"].bind(e);return"MutationObserver"in e?(o=document.createTextNode(""),function(e){var n=new MutationObserver(function(){e(),n.disconnect()});n.observe(o,{characterData:!0}),o.data=!1}):e.setImmediate||e.setTimeout;var o}(window,"oR msR mozR webkitR r".split(" "));function n(e){return"object"==typeof e||"function"==typeof e}function t(e){return n(e)&&"then"in e}function o(e,t,u,i,r){var c,f;if(t&&n(t))try{if(t===e)throw new TypeError("A promise can not be resolved by itself");c=t.then,u&&"function"==typeof c?function(e,n,t,o,u,i){try{e.call(o,function(e){n(t,e,!0,u,i)},function(e){n(t,e,!1,u,i)})}catch(e){n(t,e,!1,u,i)}}(c,(f=o,function(){f&&f.apply(this,arguments),f=null}),e,t,i,r):(u?i:r)(t)}catch(e){r(e)}else(u?i:r)(t)}var u=null;function i(e,n,t){for(var o=0,i=e.length;o<i;o++)e[o]();e.splice(),n&&u&&u(t)}function r(n){if(!(this instanceof r))return new r(n);var t=this,u=function(n){t.fulfilled||t.rejected||(t.rejected=!0,t.value=n,e(function(){i(t.queue,!t.caught,t.value)}))};t.queue=[],n(function(n){o(t,n,!0,function(n){t.fulfilled||t.rejected||(t.fulfilled=!0,t.value=n,e(function(){i(t.queue)}))},u)},u)}return r.onUncaught=function(e){u=e},r.prototype.then=function(n,t){var o=this;return t instanceof Function&&(o.caught=!0),new r(function(u,i){function r(){var e=o.fulfilled?n:t;if("function"==typeof e)try{u(e(o.value))}catch(e){i(e)}else o.fulfilled?u(o.value):i(o.value)}o.fulfilled||o.rejected?e(r):o.queue.push(r)})},r.prototype.catch=function(e){return this.then(null,e)},r.defer=function(){var e={};return e.promise=new r(function(n,t){e.resolve=n,e.reject=t}),e},r.when=function(e){return e&&e.then?e:r.resolve(e)},r.resolve=function(e){return new r(function(n){n(e)})},r.reject=function(e){return new r(function(n,t){t(e)})},r.all=function(e){var n=e.length;return new r(function(o,u){var i=new Array(n);e.forEach(function(e,r){var c=function(e){i[r]=e,--n||o(i)};t(e)?e.then.call(e,c,u):c(e)}),i.length||o(i)})},r.race=function(e){return new r(function(n,o){e.forEach(function(e){t(e)?e.then.call(e,n,o):n(e)}),e.length||n()})},r});