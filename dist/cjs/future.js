"use strict";var a=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var D=Object.prototype.hasOwnProperty;var L=(u,e)=>{for(var t in e)a(u,t,{get:e[t],enumerable:!0})},R=(u,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of m(e))!D.call(u,n)&&n!==t&&a(u,n,{get:()=>e[n],enumerable:!(i=F(e,n))||i.enumerable});return u};var C=u=>R(a({},"__esModule",{value:!0}),u);var j={};L(j,{Future:()=>y});module.exports=C(j);var o=require("./nextTick"),r=require("./type-cast"),v=(i=>(i.PENDING="PENDING",i.FULFILLED="FULFILLED",i.REJECTED="REJECTED",i))(v||{});const{PENDING:Q,FULFILLED:f,REJECTED:s}=v;class y{constructor(e){this.value=null;this.state=Q;this.fulfillQueue=[];this.rejectQueue=[];try{e(this.doResolve.bind(this),this.doReject.bind(this))}catch(t){this.doReject(t)}}doComplete(e,t){this.value=e,this.state=t,(0,o.nextTick)(()=>{const i=t===f?this.fulfillQueue:this.rejectQueue;this.fulfillQueue=null,this.rejectQueue=null,i==null||i.forEach(n=>{try{n(e)}catch(h){}})})}doResolve(e){let t=!1;try{if(e===this)throw new TypeError("resolve value is the promise itself");const i=e&&((0,r.isObject)(e)||(0,r.isFunction)(e))&&e.then;if((0,r.isFunction)(i))i.call(e,n=>{t||(t=!0,this.doResolve(n))},n=>{t||(t=!0,this.doComplete(n,s))});else{if(t)return;this.doComplete(e,f)}}catch(i){if(t)return;this.doComplete(i,s)}}doReject(e){this.doComplete(e,s)}then(e=null,t=null){return new y((i,n)=>{var p,E;const h=(0,r.isFunction)(e)?l=>{try{i(e(l))}catch(c){n(c)}}:l=>i(l),d=(0,r.isFunction)(t)?l=>{try{i(t(l))}catch(c){n(c)}}:l=>n(l);this.state===f?(0,o.nextTick)(()=>h(this.value)):this.state===s?(0,o.nextTick)(()=>d(this.value)):((p=this.fulfillQueue)==null||p.push(h),(E=this.rejectQueue)==null||E.push(d))})}}
