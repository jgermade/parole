!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):n.Parole=e()}(this,function(){var n,e,t="object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"MutationObserver"in(n="object"==typeof window?window:this)?(e=document.createTextNode(""),function(n){var t=new MutationObserver(function(){n(),t.disconnect()});t.observe(e,{characterData:!0}),e.data=!1}):n.setImmediate||n.setTimeout;function o(n){return"object"==typeof n||"function"==typeof n}function c(n){return o(n)&&"then"in n}function r(n,e,t,c,u){var i;if(e&&o(e))try{if(e===n)throw new TypeError("A promise can not be resolved by itself");i=e.then,t&&"function"==typeof i?function(n,e,t,o,c){var u=!1;try{n.call(t,function(n){u||(u=!0,r(e,n,!0,o,c))},function(n){u||(u=!0,r(e,n,!1,o,c))})}catch(n){if(u)return;r(e,n,!1,o,c)}}(i,n,e,c,u):(t?c:u)(e)}catch(n){u(n)}else(t?c:u)(e)}function u(n){if(!(this instanceof u))return new u(n);var e=this,o=function(n,o,c){e.completed||(e.completed=!0,e.fulfilled=n,e.value=o,t(function(){for(var n=0,e=c.length;n<e;n++)c[n]()},0))},c=function(n){o(!1,n,e.queue)};e.queue=[],n(function(n){r(e,n,!0,function(n){o(!0,n,e.queue)},c)},c)}return u.prototype.then=function(n,e){var o=this;return new u(function(c,r){function u(){!function(n,e,t,o,c){if("function"==typeof n)try{o(n(t))}catch(n){c(n)}else e?o(t):c(t)}(o.fulfilled?n:e,o.fulfilled,o.value,c,r)}o.completed?t(u):o.queue.push(u)})},u.prototype.catch=function(n){return this.then(null,n)},u.defer=function(){var n={};return n.promise=new u(function(e,t){n.resolve=e,n.reject=t}),n},u.when=function(n){return n&&n.then?n:u.resolve(n)},u.resolve=function(n){return new u(function(e){e(n)})},u.reject=function(n){return new u(function(e,t){t(n)})},u.all=function(n){var e=n.length;return new u(function(t,o){var r=new Array(e);n.forEach(function(n,u){var i=function(n){r[u]=n,--e||t(r)};c(n)?n.then.call(n,i,o):i(n)})})},u.race=function(n){return new u(function(e,t){n.forEach(function(n){c(n)?n.then.call(n,e,t):e(n)})})},u});