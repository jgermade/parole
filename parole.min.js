!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):n.Parole=e()}(this,function(){var n="object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:function(n,e,t,o){for(t=e.length-1;t>=0;t--)if((o=n[e[t++]+"equestAnimationFrame"])instanceof Function)return o;return n.setImmediate||n.setTimeout}("object"==typeof window?window:this,"oR msR mozR webkitR r".split(" "));function e(n){return("object"==typeof n||n instanceof Function)&&"then"in n}function t(n,e,o,i,f){var u;if(!e||"object"!=typeof e&&"function"!=typeof e)(o?i:f)(e);else try{if(e===n)throw new TypeError("A promise can not be resolved by itself");u=e.then,o&&"function"==typeof u?function(n,e,o,i,f){var u=!1;try{n.call(o,function(n){u||(u=!0,t(e,n,!0,i,f))},function(n){u||(u=!0,t(e,n,!1,i,f))})}catch(n){if(u)return;t(e,n,!1,i,f)}}(u,n,e,i,f):(o?i:f)(e)}catch(n){f(n)}}function o(e){if(!(this instanceof o))return new o(e);var i=this,f=function(e,t,o){i.completed||(i.completed=!0,i.fulfilled=e,i.value=t,n(function(){for(var n=0,e=o.length;n<e;n++)o[n]()},0))},u=function(n){f(!1,n,i.queue)};i.queue=[],e(function(n){t(i,n,!0,function(n){f(!0,n,i.queue)},u)},u)}return o.prototype.then=function(e,t){var i=this;return new o(function(o,f){function u(){!function(n,e,t,o,i){if("function"==typeof n)try{o(n(t))}catch(n){i(n)}else e?o(t):i(t)}(i.fulfilled?e:t,i.fulfilled,i.value,o,f)}i.completed?n(u):i.queue.push(u)})},o.prototype.catch=function(n){return this.then(null,n)},o.defer=function(){var n={};return n.promise=new o(function(e,t){n.resolve=e,n.reject=t}),n},o.when=function(n){return n&&n.then?n:o.resolve(n)},o.resolve=function(n){return new o(function(e){e(n)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.all=function(n){var t=n.length;return new o(function(o,i){var f=new Array(t);n.forEach(function(n,u){var c=function(n){f[u]=n,--t||o(f)};e(n)?n.then.call(n,c,i):c(n)})})},o.race=function(n){return new o(function(t,o){n.forEach(function(n){e(n)?n.then.call(n,t,o):t(n)})})},o});